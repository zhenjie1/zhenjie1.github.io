webpackJsonp([3],{"4WYF":function(t,e){},"N+Ni":function(t,e){},bBgq:function(t,e,n){(function(e){var n="Expected a function",a=NaN,i="[object Symbol]",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,r=/^0o[0-7]+$/i,u=parseInt,f="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,d=f||l||Function("return this")(),h=Object.prototype.toString,v=Math.max,p=Math.min,b=function(){return d.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&h.call(t)==i}(t))return a;if(m(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=m(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=c.test(t);return n||r.test(t)?u(t.slice(2),n?2:8):s.test(t)?a:+t}t.exports=function(t,e,a){var i,o,s,c,r,u,f=0,l=!1,d=!1,h=!0;if("function"!=typeof t)throw new TypeError(n);function _(e){var n=i,a=o;return i=o=void 0,f=e,c=t.apply(a,n)}function k(t){var n=t-u;return void 0===u||n>=e||n<0||d&&t-f>=s}function w(){var t=b();if(k(t))return y(t);r=setTimeout(w,function(t){var n=e-(t-u);return d?p(n,s-(t-f)):n}(t))}function y(t){return r=void 0,h&&i?_(t):(i=o=void 0,c)}function x(){var t=b(),n=k(t);if(i=arguments,o=this,u=t,n){if(void 0===r)return function(t){return f=t,r=setTimeout(w,e),l?_(t):c}(u);if(d)return r=setTimeout(w,e),_(u)}return void 0===r&&(r=setTimeout(w,e)),c}return e=g(e)||0,m(a)&&(l=!!a.leading,s=(d="maxWait"in a)?v(g(a.maxWait)||0,e):s,h="trailing"in a?!!a.trailing:h),x.cancel=function(){void 0!==r&&clearTimeout(r),f=0,i=u=o=r=void 0},x.flush=function(){return void 0===r?c:y(b())},x}}).call(e,n("9AUj"))},i1TO:function(t,e,n){"use strict";n.d(e,"a",function(){return v}),n.d(e,"c",function(){return b}),n.d(e,"e",function(){return m}),n.d(e,"d",function(){return g}),n.d(e,"b",function(){return _});var a,i,o=n("lC5x"),s=n.n(o),c=n("J0Oq"),r=n.n(c),u=n("rVsN"),f=n.n(u),l=n("K2f2"),d=n("yclV"),h=(a=r()(s.a.mark(function t(e,n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=n,t.next=1===t.t0?3:2===t.t0?5:3===t.t0?8:4===t.t0?11:5===t.t0?14:17;break;case 3:return Object(l.D)(1).then(function(t){e.total=t.total,t=t.rows,e.infoData=t,e.originalData=t}),t.abrupt("break",17);case 5:return t.next=7,Object(l.E)().then(function(t){t=t.rows,e.infoData=t,e.originalData=t});case 7:return t.abrupt("break",17);case 8:return t.next=10,Object(l.B)().then(function(t){t=t.rows,e.infoData=t,e.originalData=t});case 10:return t.abrupt("break",17);case 11:return t.next=13,Object(l.C)(1).then(function(t){t=t.rows,e.infoData=t,e.originalData=t});case 13:return t.abrupt("break",17);case 14:return t.next=16,Object(l.D)(1,"99").then(function(t){t=t.rows,e.infoData=t,e.originalData=t});case 16:return t.abrupt("break",17);case 17:e.liLength=e.$refs.li.length;case 18:case"end":return t.stop()}},t,this)})),function(t,e){return a.apply(this,arguments)});!function t(){try{i=parseInt(Object(d.a)("userInfo").userType)}catch(t){}i||setTimeout(function(){t()},200)}();var v=function(t,e){e=parseInt(e),new f.a(function(n,a){switch(e){case 2:Object(l.k)().then(function(e){e=e.rows,t.infoData=e,t.originalData=e,n(e)}).then(function(){t.isShow()});break;case 3:Object(l.D)(1).then(function(e){t.total=e.total,e=e.rows,t.infoData=e,t.originalData=e,t.liLength=e.length,n(e)});break;case 4:Object(l.i)(1).then(function(e){t.total=e.total,e=e.rows,t.infoData=e,t.originalData=e,t.liLength=e.length,n(e)})}}).then(function(e){p(t,t.navIndex)})},p=function(t,e){setTimeout(function(){t.liLength=void 0==t.$refs.li?0:t.$refs.li.length},0)},b=function(t,e,n,a,i){e=parseInt(e),t.clickObj=n,t.originaId=n.id,2===e||4==e?function(t,e,n,a){switch(e.stateId=parseInt(e.stateId),e.stateId){case 0:1==n?(t.originaId=e.id,t.isShowPer=!0):t.showCancelRefuse=!0;break;case 2:case 3:1==n&&t.statusSet(e);break;case 4:console.log("不请求，而是跳转页面 --- 点击的是第 "+n+" 个"),-1!==a.indexOf("上传")&&console.log("点击的是上传·");break;default:console.log("报错了，快去看看代码吧！"),t.statusSet(e)}}(t,n,a,i):3===e&&1==a&&-1!==i.indexOf("取消")&&(t.showCancel=!0)},m=function(t){var e=t.navIndex;2==i||4==i?_(t,e):3==i&&h(t,e)},g=function(t,e){if(t=parseInt(t),2==i||4==i){e.typeReport,e.typeReturn;var n=[[{name:"拒绝接单",type:"button"},{name:"确认接单",type:"button"}],[{name:"确认出发",type:"button"}],[{name:"拍摄",type:"file"},{name:"确认到达",type:"button"}],[{name:"拍摄",type:"file"},{name:"完成",type:"button"}]];switch(t){case 0:t="等待接单",e.btn=n[0];break;case 1:t="等待出发",e.btn=n[1];break;case 2:t="在途中",e.btn=n[2];break;case 3:t="施救中",e.btn=n[3];break;case 4:t="完成",e.btn=n[4];break;default:t="未知状态"}}else if(3==i){n=[[{name:"救援进展",type:"button"},{name:"取消订单",type:"button"}],[{name:"救援进展",type:"button"}],[{name:"救援进展",type:"button"}],[{name:"救援进展",type:"button"}],[{name:"救援进展",type:"button"}]];switch(t){case 0:t="等待接单",e.btn=n[0];break;case 1:t="等待出发",e.btn=n[1];break;case 2:t="在途中",e.btn=n[2];break;case 3:t="施救中",e.btn=n[2];break;case 4:t="已完成",e.btn=n[3];break;case 99:t="已取消",e.btn=n[4];break;default:t="未知状态"}}return t},_=function(t,e){new f.a(function(n,a){if(4!=e){var i=[];Array.isArray(t.originalData)&&(t.originalData.forEach(function(t,n){1==e?0!=t.stateId&&1!=t.stateId||i.push(t):e==t.stateId&&i.push(t)}),t.infoData=i,n())}else Object(l.m)(1,10).then(function(e){e=e.rows,t.infoData=e,n()})}).then(function(){p(t,e)})}},"kt+X":function(t,e){},oXQb:function(t,e){},sFWC:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("hRKE"),i=n.n(a),o=n("XaLk"),s=(n("ij9N"),n("K2f2")),c={data:function(){return{data:[]}},props:["originaId"],methods:{ok:function(){var t=this,e=[];if(this.data.forEach(function(t){t.check&&e.push(t.id)}),0===e.length)return alert("请至少选择一人！"),!1;Object(s.a)(this.originaId,e).then(function(e){2==e.code?(t.$emit("down",!0),alert("接单成功")):t.$emit("down",e.msg)})},initData:function(){var t=this;Object(s.l)().then(function(e){t.data=e.rows})},down:function(){this.$emit("down",!1)}},created:function(){this.initData()}},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"personnel"},[n("div",{staticClass:"con"},[n("div",{staticClass:"down",on:{click:t.down}},[n("i",{staticClass:"iconfont icon-guanbi"})]),t._v(" "),t._m(0),t._v(" "),n("div",{staticClass:"pers"},t._l(t.data,function(e,a){return 0==e.status?n("p",{key:a,class:{checked:e.check},on:{click:function(t){e.check=!e.check}}},[t._v(t._s(e.name))]):t._e()})),t._v(" "),n("div",{staticClass:"okBtn",on:{click:t.ok}},[n("span",[t._v("选择好了")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tit"},[e("span",[this._v("请选择出勤人员")])])}]};var u=n("vSla")(c,r,!1,function(t){n("kt+X")},"data-v-651c048c",null).exports,f=n("vgQg"),l=n("yclV"),d=n("i1TO"),h=n("wEVy"),v={data:function(){return{showCancelRefuse:!1,showCancel:!1,navIndex:1,currentView:"orders",isShowPer:!1,infoData:[],pageNum:1,liLength:-1,userType:"",total:0,socketData:{},originalData:[],originaId:"",clickObj:"",test:"",RescueMenu:[]}},filters:{progress:function(t){return 0==t.length?"等待救援人员接单":t[0]},office:function(t){return"object"==(void 0===t?"undefined":i()(t))?t.name:""==t||void 0==t?"救援机构未分配":t},status:function(t,e){return Object(d.d)(t,e)}},created:function(){Object(h.a)(this)},methods:{cancelRefuseEv:function(t){var e=this;""!=t?Object(s.b)(this.originaId,t).then(function(t){e.clickObj.stateId="99"}):alert("请输入拒绝理由！")},localItem:function(t){Object(l.b)("viewCurrentData",t)},cancelEv:function(t){var e=this;""!=t?Object(s.c)(this.originaId,t).then(function(t){console.log(t),e.clickObj.stateId="99"}):alert("请输入拒绝理由！")},mapEv:function(t){sessionStorage.lngLat=t.jingwei},imgResult:function(t){t.target.files.length>0?alert("拍摄成功"):alert("您未拍摄照片")},listIsShow:function(t){return 2==this.userType||4==this.userType?1==this.navIndex?0==t.stateId||1==t.stateId:t.stateId==this.navIndex:3==this.userType||void 0},isShow:function(){Object(d.e)(this)},personal:function(){3==this.userType?this.$router.push("/user/home"):this.$router.push("/personal")},initData:function(){Object(d.a)(this,this.userType)},downEv:function(t){if(!0===t){for(var e=0;e<this.infoData.length;e++)if(this.infoData[e].id==this.originaId){this.infoData[e].stateId=1;break}this.isShowPer=!1}else!1===t?this.isShowPer=!1:alert(t)},statusSet:function(t){var e=this;Object(s.s)(t.id,t.stateId+1).then(function(n){t.stateId=t.stateId+1,Object(d.b)(e,e.navIndex)})},accept:function(t,e,n){Object(d.c)(this,this.userType,t,e,n)}},mounted:function(){var t=this;try{this.userType=Object(l.a)("userInfo").userType}catch(t){this.$router.push("/user/login")}this.RescueMenu=3==this.userType?f.c:f.a,this.initData();var e,n;3!=this.userType&&(e=function(e){t.infoData.splice(0,0,e),console.log(e)},(n=new WebSocket("ws://118.25.40.163:8088")).onopen=function(t){console.log("连接成功"),n.send("Hello WebSockets!")},n.onmessage=function(t){console.log("接受的数据是: "+t.data);var n="string"==typeof t.data?JSON.parse(t.data):t.data;e(n)},n.onclose=function(t){console.log("断开连接")})},components:{Personnel:u,BottomLine:n("zG2y").a,Confirm:o.a}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task"},[n("ul",{staticClass:"nav"},t._l(t.RescueMenu,function(e,a){return n("li",{key:a,class:{checked:a==t.navIndex-1},on:{click:function(e){t.navIndex=a+1,t.isShow()}}},[n("span",[t._v(t._s(e))])])})),t._v(" "),n("div",{staticClass:"ordersComm Orders"},[n("ul",t._l(t.infoData,function(e,a){return t.listIsShow(e)?n("li",{key:a,ref:"li",refInFor:!0,class:"order",on:{click:function(n){t.localItem(e)}}},[n("router-link",{attrs:{to:"/rescue/task/details"}},[n("div",{staticClass:"title"},[n("p",[t._v("救援单号："+t._s(e.uuid))]),t._v(" "),n("span",[t._v(t._s(t._f("status")(e.stateId,e)))])]),t._v(" "),3==t.userType&&0!=e.orderStautsList.length?n("div",{staticClass:"track"},[n("i",{staticClass:"iconfont icon-che"}),t._v(" "),n("div",{staticClass:"r"},[n("h2",[t._v(t._s(t._f("progress")(e.orderStautsList)))]),t._v(" "),n("span",[t._v("2018-03-06 08:50:33")])])]):t._e(),t._v(" "),n("div",{staticClass:"info"},[n("img",{staticClass:"icon",attrs:{src:"",alt:""}}),t._v(" "),n("div",{staticClass:"con"},[n("h3",[t._v(t._s(t._f("office")(e.office)))]),t._v(" "),n("p",[n("span",[t._v(t._s(t._f("Rescue")(e.rangeId)))]),t._v(" "),n("b",[t._v(t._s(e.createDate))])])])])]),t._v(" "),""!==e.remarks?n("div",{staticClass:"note"},[n("i",{staticClass:"iconfont icon-jinggao"}),t._v(" "),n("span",[t._v("备注")]),t._v(" "),n("p",[t._v(t._s(e.remarks))])]):t._e(),t._v(" "),n("router-link",{attrs:{to:"/rescue/map"},nativeOn:{click:function(n){t.mapEv(e)}}},[n("div",{staticClass:"position"},[n("i",{staticClass:"iconfont icon-weizhi"}),t._v(" "),n("p",[t._v(t._s(e.place))]),t._v(" "),n("span",[t._v("22.22km")]),t._v(" "),n("b",{attrs:{href:""}},[t._v("查看地图 "),n("i",{staticClass:"iconfont icon-shuangjiantouyou"})])])]),t._v(" "),0!=e.btn.length?n("div",{staticClass:"btn"},t._l(e.btn,function(a,i){return n("div",{key:i,class:{file:"file"==a.type}},["file"==a.type?n("span",[t._v(t._s(a.name))]):t._e(),t._v(" "),n("input",{attrs:{type:a.type,accept:"image/*",capture:"camera"},domProps:{value:"button"==a.type?a.name:""},on:{click:function(n){t.accept(e,i,a.name)},change:t.imgResult}})])})):t._e()],1):t._e()})),t._v(" "),n("transition",{attrs:{name:"breadcrumb"}},[n("router-view"),t._v(" "),t.isShowPer?n("personnel",{attrs:{originaId:t.originaId},on:{down:t.downEv}}):t._e()],1)],1),t._v(" "),n("confirm",{attrs:{"hide-on-blur":!0,"show-input":!0,placeholder:"请输入取消理由",title:"取消理由",theme:"android","confirm-text":"确定","cancel-text":"取消"},on:{"on-confirm":t.cancelEv},model:{value:t.showCancel,callback:function(e){t.showCancel=e},expression:"showCancel"}}),t._v(" "),n("confirm",{attrs:{"hide-on-blur":!0,"show-input":!0,placeholder:"请输入拒绝理由",title:"拒绝理由",theme:"android","confirm-text":"确定","cancel-text":"取消"},on:{"on-confirm":t.cancelRefuseEv},model:{value:t.showCancelRefuse,callback:function(e){t.showCancelRefuse=e},expression:"showCancelRefuse"}}),t._v(" "),t.liLength>0?n("bottom-line"):t._e(),t._v(" "),0==t.liLength?n("div",{staticClass:"Empty"},[n("i",{staticClass:"iconfont icon-icondd1"}),n("p",[t._v("暂无数据")])]):t._e(),t._v(" "),3!=t.userType?n("div",{staticClass:"personal",on:{click:t.personal}},[n("i",{staticClass:"iconfont icon-wode"})]):n("div",{staticClass:"personal",on:{click:t.personal}},[n("i",{staticClass:"iconfont icon-home"})])],1)},staticRenderFns:[]};var b=n("vSla")(v,p,!1,function(t){n("N+Ni"),n("oXQb")},"data-v-54d5137a",null);e.default=b.exports},wEVy:function(t,e,n){"use strict";var a,i,o=n("lC5x"),s=n.n(o),c=n("J0Oq"),r=n.n(c),u=n("K2f2"),f=n("yclV"),l=(a=r()(s.a.mark(function t(e,n){var a,i,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Object(f.a)("userInfo").userType,i=e.navIndex,o=[],3!=a){t.next=14;break}if(1!=i){t.next=9;break}return t.next=7,Object(u.D)(n).then(function(t){o=t.rows});case 7:t.next=12;break;case 9:if(4!=i){t.next=12;break}return t.next=12,Object(u.C)(n).then(function(t){o=t.rows});case 12:t.next=17;break;case 14:if(2!=a){t.next=17;break}return t.next=17,Object(u.m)(n).then(function(t){o=t.rows});case 17:h(e,o,"infoData");case 18:case"end":return t.stop()}},t,this)})),function(t,e){return a.apply(this,arguments)}),d=(i=r()(s.a.mark(function t(e,n,a){var i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=[],t.next=3,Object(u.f)(n,a).then(function(t){i=t.rows,e.isShowLoading=!1});case 3:h(e,i,"data");case 4:case"end":return t.stop()}},t,this)})),function(t,e,n){return i.apply(this,arguments)});function h(t,e,n){e.forEach(function(e){t[n].push(e)})}var v,p=n("bBgq"),b=n.n(p);e.a=function(t){v=t,window.addEventListener("scroll",b()(m,500))};function m(){if(function(){var t=0,e=0;document.body&&(t=document.body.scrollTop);document.documentElement&&(e=document.documentElement.scrollTop);return t-e>0?t:e}()+function(){var t=0;t="CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight;return t}()==function(){var t=0,e=0;document.body&&(t=document.body.scrollHeight);document.documentElement&&(e=document.documentElement.scrollHeight);return t-e>0?t:e}())if(-1!==v.$route.path.indexOf("/rescue/task")){if(v.total<10*v.pageNum)return;v.pageNum++,l(v,v.pageNum)}else if(-1!==v.$route.path.indexOf("/user/home")){if(v.total<10*v.pageNum)return;v.isShowLoading=!0;var t="sense"==v.currentView?"1":"2";v.pageNum++,d(v,v.pageNum,t)}}},zG2y:function(t,e,n){"use strict";var a={props:["text"],data:function(){return{txt:""}},mounted:function(){this.txt=void 0!==this.text?this.text:"我是有底线的"}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"bottomLine"},[e("p",[this._v(this._s(this.txt))])])},staticRenderFns:[]};var o=n("vSla")(a,i,!1,function(t){n("4WYF")},"data-v-2935bb20",null);e.a=o.exports}});