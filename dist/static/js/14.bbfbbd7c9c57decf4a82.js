webpackJsonp([14],{"AIV+":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("K2f2"),i={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"hello"},[e("div",{staticClass:"upload"})])}]};var r=a("C7Lr")({name:"imgUpdate",data:function(){return{}},methods:{},mounted:function(){}},i,!1,function(t){a("BgnW")},"data-v-0333f5a5",null).exports,s={name:"update",data:function(){return{title:"",index:"",arr:[{value:"",value1:""}],content:"",contentImg:"",reportAndReturn:""}},components:{imgUpdate:r},methods:{cil:function(t){this.index=t},delet:function(t){this.arr[t].value1=""},update:function(t){var e=this,a=new FormData;a.append("file",t);Object(n.R)(a,"upImg",{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.arr[e.index].value1=t.rows.url})},dataURLtoFile:function(t,e){for(var a=t.split(","),n=a[0].match(/:(.*?);/)[1],i=atob(a[1]),r=i.length,s=new Uint8Array(r);r--;)s[r]=i.charCodeAt(r);return new File([s],e,{type:n})},photoCompress:function(t,e,a){var n=this,i=new FileReader;i.readAsDataURL(t),i.onload=function(){var t=this.result;n.canvasDataURL(t,e,a)}},canvasDataURL:function(t,e,a){var n=new Image;n.src=t,n.onload=function(){var t=this.width,n=this.height,i=t/n;t=e.width||t,n=e.height||t/i;var r=.7,s=document.createElement("canvas"),o=s.getContext("2d"),l=document.createAttribute("width");l.nodeValue=t;var u=document.createAttribute("height");u.nodeValue=n,s.setAttributeNode(l),s.setAttributeNode(u),o.drawImage(this,0,0,t,n),e.quality&&e.quality<=1&&e.quality>0&&(r=e.quality);var c=s.toDataURL("image/jpeg",r);a(c)}},UpladFile:function(t){var e=this;this.loadingShow=!0;var a=t.target.files[0];a.size/1024>1025?e.photoCompress(a,{quality:.5},function(t){var n=e.dataURLtoFile(t,a.name);e.update(n)}):e.update(a)},addEle:function(){this.arr.push({value:"",value1:""})},submit:function(){var t=this,e=this.arr,a=e.length,i=this.$route.params.id,r=this.$route.params.sta;if(this.content="",this.contentImg="",""!=this.title){for(var s=0;s<a;s++)s==a-1?(this.content+=e[s].value,this.contentImg+=e[s].value1):(this.content+=e[s].value+"%##%",this.contentImg+=e[s].value1+"%##%");""!=this.content.replace("%##%","")?Object(n.k)(i,this.content,this.contentImg,this.title,r).then(function(e){e&&2==e.code&&t.$router.go(-1)}):this.$vux.toast.text("内容不能为空")}else this.$vux.toast.text("标题不能为空")}},created:function(){var t=this.$route.params.sta;document.title="0"==t?"上传回访":"上传报告",this.reportAndReturn=document.title.replace("上传","")}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"update"},[a("div",{staticClass:"tit"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text",maxlength:"20",placeholder:"请输入"+t.reportAndReturn+"的标题"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"box"},t._l(t.arr,function(e,n){return a("div",{key:n,staticClass:"con",on:{click:function(e){t.cil(n)}}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.arr[n].value,expression:"arr[i].value"}],attrs:{name:"",placeholder:"请在此输入救援"+t.reportAndReturn+"信息内容"},domProps:{value:t.arr[n].value},on:{input:function(e){e.target.composing||t.$set(t.arr[n],"value",e.target.value)}}}),t._v(" "),a("div",{staticClass:"item"},[a("span",[t._v("添加照片")]),t._v(" "),a("input",{staticClass:"avatarStyle",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:function(e){t.UpladFile(e)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.arr[n].value1,expression:"arr[i].value1"}],attrs:{type:"hidden"},domProps:{value:t.arr[n].value1},on:{input:function(e){e.target.composing||t.$set(t.arr[n],"value1",e.target.value)}}}),t._v(" "),a("img",{class:""==t.arr[n].value1?"hide":"show",attrs:{src:t.arr[n].value1,alt:""}}),t._v(" "),a("i",{staticClass:"delet",class:""==t.arr[n].value1?"hide":"show",on:{click:function(e){t.delet(n)}}},[t._v("-")])])])})),t._v(" "),a("div",{staticClass:"add",on:{click:t.addEle}},[t._v("+")]),t._v(" "),a("button",{staticClass:"submit",on:{click:t.submit}},[t._v("确认提交")])])},staticRenderFns:[]};var l=a("C7Lr")(s,o,!1,function(t){a("Yl37")},"data-v-405c4c9e",null);e.default=l.exports},BgnW:function(t,e){},Yl37:function(t,e){}});